"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[3878],{8447:(e,a,t)=>{t.r(a),t.d(a,{default:()=>Oa});var i=t(67294),n=t(86706),l=t(51615),s=t(69518),r=t.n(s),d=t(32667),c=t(87577),o=t(95222),m=t(96206),u=t(42038),k=t(83056);const p=(e,a,t)=>({event:e,app_startup_id:null,ad_playback_id:null,ad_id:String(a),lineitem_id:String(t),creative_id:String(a),ad_format:"sponsored playlist",slot:null,in_focus:null,username:null,jsondata:JSON.stringify({platform:"WebPlayer",revision:"1.0.0"})}),v=({clickTracking:e,clickThrough:a,thirdPartyImpression:t,impression:l,logoUrl:s,advertiserName:r,creativeId:c,lineItemId:o})=>{const u=(0,n.I0)(),[v,S]=(0,i.useState)(!1);return(0,i.useEffect)((()=>(u((0,k.Vw)()),u((0,k.kh)(p("event_viewed",c,o))),()=>{u((0,k.AG)())})),[u,c,o]),i.createElement("div",{className:"sponsor-container"},i.createElement(d.D,{variant:"minuet",className:"sponsor-text","data-ta-id":"sponsor-text"},m.ag.get("playlist.presented_by",r)),i.createElement("div",{className:"sponsor-logo"},i.createElement("a",{draggable:!1,className:"sponsor-logo__link",target:"_blank",href:a,onClick:()=>{u((0,k.kh)(p("event_clicked",c,o))),S(!0)}},i.createElement("img",{draggable:!1,className:"sponsor-logo__image",src:s,alt:r,"data-ta-id":"sponsor-logo"})),i.createElement("img",{className:"sponsor-logo__imp-pixel",src:l,alt:""}),t&&i.createElement("img",{className:"sponsor-logo__3p-imp-pixel",src:t,alt:""}),v&&i.createElement("img",{className:"sponsor-logo__click-img-pixel",src:e,alt:""})))},S=({playlistUri:e})=>{const a=(0,n.I0)(),t=(0,n.v9)((a=>a.ads.sponsoredPlaylist.previewAd||a.ads.sponsoredPlaylist.sponsoredPlaylist.get(e)));return(0,i.useEffect)((()=>{t||a((0,k.fd)(e))}),[a,e,t]),t?i.createElement("div",null,i.createElement(v,t)):null},y=({playlistUri:e})=>{const a=(0,n.I0)(),t=(0,n.v9)((e=>e.ads.sponsoredPlaylist.sponsoredPlaylist.get("allSponsorships"))),l=(0,n.v9)((e=>e.ads.sponsoredPlaylist.previewAd));(0,i.useEffect)((()=>{t||a((0,k.z8)())}),[a,t]);const s=l||t&&((e,a)=>{const t=Date.now()/1e3,i=e.split(":"),n=i[i.length-1];return a.some((({playlistId:e,endTime:a,startTime:i})=>e===n&&t>=i&&t<(a||t+1)))})(e,t);return s?i.createElement(S,{playlistUri:e}):null};var b=t(18270),g=t(43683),N=t(48690),E=t(35410),f=t(20534),h=t(70369),F=t(30731),T=t(98778),C=t(21317),R=t(34011),A=t(4383);const I="hOOwEKqNuXrNvOCB1SgZ",L="csEdkIN9z2LjJIuZraqz",D=({uri:e})=>{const[a,t]=(0,A.Z)(e),n=(0,l.k6)(),s=(0,i.useCallback)((()=>{t(!1),n.replace("/collection/playlists")}),[n,t]);return i.createElement("div",{className:I},i.createElement(C.l,{iconSize:64}),i.createElement("div",{className:L},i.createElement(d.D,{as:"p",variant:"canon"},m.ag.get("forbidden-page.title")),i.createElement(d.D,{as:"p",variant:"mesto"},m.ag.get("forbidden-page.description"))),a&&i.createElement(R.D,{colorSet:"invertedLight",onClick:s},m.ag.get("remove_from_your_library")))};var U=t(84200),x=t(6158),P=t(58679),w=t(55120),_=t(77834),M=t(1838),O=t(22423),B=t(78462),V=t(61412),Q=t(12498),Z=t(69846),z=t(57784),G=t(56802),K=t(4236),q=t(62515),W=t(97181),X=t(53538),j=t(49207),H=t(29255),J=t(44065),$=t(51441),Y=t(20246),ee=t(32648),ae=t(84242),te=t(72138),ie=t(73893),ne=t(42714),le=t(28018),se=t(88767),re=t(62830);var de=t(97194),ce=t(54444),oe=t(28248),me=t(42922),ue=t(49961);const ke=new Set(B.RJ),pe=new Set([]),ve={column:null,order:oe.kn.NONE},Se=i.memo((function({ariaLabel:e,nrTracks:a,playlistUri:t,rankType:n,scrollToUid:l,usePlayContextItem:s,tracklistDomRef:r}){const d=(0,i.useContext)(te.ZF),{filter:c,setFilter:o}=(0,i.useContext)(O.fo),m=(0,i.useRef)(null),[u,k]=(0,i.useState)(a),p=(0,i.useCallback)((()=>{m.current&&m.current.update()}),[]);(0,le.r)(t,p);const{sortState:v,setSortState:S}=(0,i.useContext)(B.Gb),y=(0,i.useCallback)((e=>{S((0,M.VK)(e,v))}),[v,S]);(0,i.useEffect)((()=>{m.current&&m.current.update()}),[v,c]),(0,i.useEffect)((()=>{S(ve),o("")}),[t,o,S]),(0,i.useEffect)((()=>{m.current&&l&&m.current.scrollToItem({uid:l})}),[l]),(0,i.useEffect)((()=>{m.current&&""===c&&m.current.scrollToFirstSelected()}),[c,u]);const b=(0,i.useCallback)((async(e,a)=>{const i=await d.getContents(t,{offset:e,limit:a,sort:(0,M._j)(v),filter:c,decorateFormatListData:!0});return i.totalLength!==u&&k(i.totalLength),i.items}),[t,d,u,v,c]),g="plays"===n,N=(0,i.useCallback)(((e,a)=>{const n=(0,ue.X)(e.album?.images,{desiredSize:40,desiredLabel:"small"});return i.createElement(oe.h_,{key:a+e.uri,index:a,contextUri:t,uri:e.uri,uid:e.uid||void 0,isPlayable:e.isPlayable,duration_ms:e.duration.milliseconds,name:e.name,artists:e.artists,album:e.album,isExplicit:e.isExplicit,isMOGEFRestricted:e.is19PlusOnly,type:e.type,imgUrl:n?.url||"",statusChange:e.formatListAttributes?.status,showPlayCount:g,playCount:parseInt(e.formatListAttributes?.rank||"0",10),usePlayContextItem:s})}),[t,g,s]),E=(0,i.useMemo)((()=>g?[oe.QD.INDEX,oe.QD.TITLE,oe.QD.PLAYS,oe.QD.ALBUM,oe.QD.DURATION]:[oe.QD.INDEX,oe.QD.TITLE,oe.QD.ALBUM,oe.QD.DURATION]),[g]),f=(0,i.useCallback)((e=>e.uri),[]),h=(0,i.useCallback)((e=>e.id),[]);return i.createElement(me.ZP,{value:"chart-tracklist"},i.createElement(oe.Pv,{key:t,ariaLabel:e,hasHeaderRow:!0,columns:E,sortableColumns:d.getCapabilities().canSort?ke:pe,sortState:v,onSort:y,renderRow:N,resolveUri:f,resolveUid:h,nrTracks:u,fetchTracks:b,limit:100,canFetchAllTracks:d.getCapabilities().canFetchAllTracks,outerRef:m,outerDomRef:r}))}));var ye=t(87462),be=t(47647),ge=t(83692),Ne=t(51627);const Ee="x-contributorButton-ContributorButton",fe=({uri:e,label:a,onClick:t,...n})=>{const{onCopyLink:l}=(0,Ne.l)({uri:e,permissionLevel:"CONTRIBUTOR"});return i.createElement(ge.w,{label:a},i.createElement(be.t,(0,ye.Z)({},n,{className:Ee,onClick:e=>{t?.(e),l?.()},iconSize:32})))};var he=t(40786),Fe=t(39714),Te=t(86604),Ce=t(98197),Re=t(3775);t(98984);const Ae={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"querySearch"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"term"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"search"},arguments:[{kind:"Argument",name:{kind:"Name",value:"query"},value:{kind:"Variable",name:{kind:"Name",value:"term"}}},{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"IntValue",value:"5"}},{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"IntValue",value:"0"}},{kind:"Argument",name:{kind:"Name",value:"numberOfTopResults"},value:{kind:"IntValue",value:"10"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"query"}},{kind:"Field",name:{kind:"Name",value:"tracks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uid"}},{kind:"Field",name:{kind:"Name",value:"track"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"playability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"playable"}},{kind:"Field",name:{kind:"Name",value:"reason"}}]}},{kind:"Field",name:{kind:"Name",value:"artists"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"album"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"coverArt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"contentRating"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"label"}}]}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"artists"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}}]}},{kind:"Field",name:{kind:"Name",value:"visuals"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"avatarImage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"albums"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"coverArt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"episodes"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uid"}},{kind:"Field",name:{kind:"Name",value:"episode"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"playability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"playable"}},{kind:"Field",name:{kind:"Name",value:"reason"}}]}},{kind:"Field",name:{kind:"Name",value:"contentRating"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"label"}}]}},{kind:"Field",name:{kind:"Name",value:"coverArt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"podcast"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}}]}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"topResults"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Artist"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Episode"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Album"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Track"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}}]}}]}}]}}]}}]}}]},Ie={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"querySearchAlbum"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"offset"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"limit"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"album"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uri"},value:{kind:"Variable",name:{kind:"Name",value:"uri"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"coverArt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"tracks"},arguments:[{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"Variable",name:{kind:"Name",value:"offset"}}},{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"Variable",name:{kind:"Name",value:"limit"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalCount"}},{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uid"}},{kind:"Field",name:{kind:"Name",value:"track"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"playability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"playable"}},{kind:"Field",name:{kind:"Name",value:"reason"}}]}},{kind:"Field",name:{kind:"Name",value:"artists"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"contentRating"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"label"}}]}}]}}]}}]}}]}}]}}]},Le={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"querySearchArtist"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"offset"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"limit"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"artist"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uri"},value:{kind:"Variable",name:{kind:"Name",value:"uri"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"following"}},{kind:"Field",name:{kind:"Name",value:"sharingInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"shareId"}}]}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}}]}},{kind:"Field",name:{kind:"Name",value:"visuals"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"avatarImage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"discography"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"popularReleases"},arguments:[{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"Variable",name:{kind:"Name",value:"offset"}}},{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"Variable",name:{kind:"Name",value:"limit"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalCount"}},{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"releases"},arguments:[{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"IntValue",value:"1"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"coverArt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"label"}},{kind:"Field",name:{kind:"Name",value:"playability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"playable"}},{kind:"Field",name:{kind:"Name",value:"reason"}}]}}]}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"topTracks"},arguments:[{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"Variable",name:{kind:"Name",value:"offset"}}},{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"Variable",name:{kind:"Name",value:"limit"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uid"}},{kind:"Field",name:{kind:"Name",value:"track"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"playability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"playable"}},{kind:"Field",name:{kind:"Name",value:"reason"}}]}},{kind:"Field",name:{kind:"Name",value:"contentRating"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"label"}}]}},{kind:"Field",name:{kind:"Name",value:"artists"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"album"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"coverArt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}}]}}]}}]}}]}}]}}]}}]}}]};var De=t(94184),Ue=t.n(De),xe=t(24697),Pe=t(44295);const we="WIBrW3xa1aqQaLWZhp5U",_e="l42JW4EP_5CU1Ba7jYIc",Me="yGtsjz2AjzhRMTphe2BO",Oe="TuU4JSqLFdjOeTaHaDmA",Be="zOwN1vkkgX9JIvE81_B2",Ve="eWEdt6BMCWITt5najIg_",Qe=i.memo((function({placeholder:e,onChange:a=(()=>{}),onFocus:t=(()=>{})}){const[n,l]=(0,i.useState)(""),s=(0,i.useRef)(null),r=(0,xe.y1)((e=>{a(e)}),200),c=(0,i.useCallback)((e=>{const a=e.currentTarget.value;l(a),r(a)}),[l,r]),o=(0,i.useCallback)((()=>{s.current&&s.current.focus(),l(""),a("")}),[l,a]),u=(0,i.useCallback)((e=>{"Escape"===e.key&&n&&o()}),[n,o]);return i.createElement("div",{className:we,role:"search"},i.createElement(d.D,{as:"input",variant:"mesto",ref:s,className:Ue()(_e),role:"searchbox",maxLength:80,autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,placeholder:e,onChange:c,onKeyDown:u,onFocus:t,value:n}),i.createElement("div",{className:Me},i.createElement("span",{className:Oe},i.createElement(Pe.j,{iconSize:16,className:Be,"aria-hidden":"true"})),n&&i.createElement("button",{className:Ve,onClick:o,"aria-label":m.ag.get("search.a11y.clear-input")},i.createElement(Fe.k,{iconSize:16}))))}));var Ze=t(7073),ze=t(42781);const Ge=e=>({uid:e.uid,uri:e.track.uri,name:e.track.name,isPlayable:e.track.playability.playable,isMOGEFRestricted:e.track.contentRating.label===Ze.KS.NineteenPlus,isExplicit:e.track.contentRating.label===Ze.KS.Explicit,album:{id:e.track.album.id,name:e.track.album.name,imgUrl:e.track.album.coverArt?.sources[0].url||"",uri:e.track.album.uri},artists:e.track.artists.items.map((e=>({id:e.id,uri:e.uri,name:e.profile.name})))}),Ke=e=>({uid:e.uid,uri:e.episode.uri,name:e.episode.name,isPlayable:e.episode.playability.playable,isMOGEFRestricted:e.episode.contentRating.label===Ze.KS.NineteenPlus,isExplicit:e.episode.contentRating.label===Ze.KS.Explicit,imgUrl:e.episode.coverArt.sources[0].url,podcast:{id:e.episode.podcast.id,uri:e.episode.podcast.uri,name:e.episode.podcast.name}}),qe=({renderRow:e,searchResults:a})=>i.createElement(oe.Pv,{ariaLabel:m.ag.get("search.title.top-results"),renderRow:e,rowPlaceholder:oe.hU,nrTracks:a.length,tracks:a,resolveUri:e=>e.uri,columns:[oe.QD.TITLE,oe.QD.ALBUM,oe.QD.ADD],testID:"playlist-inline-curation-loaded-results"}),We=({renderRow:e,searchResults:a})=>i.createElement(oe.Pv,{ariaLabel:m.ag.get("search.title.top-results"),renderRow:e,rowPlaceholder:oe.hU,nrTracks:a.length,tracks:a,resolveUri:e=>e.uri,columns:[oe.QD.TITLE,oe.QD.ALBUM,oe.QD.ADD]}),Xe=({renderRow:e,searchResults:a})=>{const t=a.filter((e=>void 0!==e.album)),n=a.filter((e=>e.uri.includes("album")));return i.createElement("div",null,i.createElement(d.D,{as:"p",variant:"cello",className:_.Z.artistResultListTitle},m.ag.get("playlist.curation.popular_songs")),i.createElement(oe.Pv,{ariaLabel:m.ag.get("playlist.curation.popular_songs"),renderRow:e,rowPlaceholder:oe.hU,nrTracks:t.length,tracks:t,resolveUri:e=>e.uri,columns:[oe.QD.TITLE,oe.QD.ALBUM,oe.QD.ADD]}),i.createElement(d.D,{as:"p",variant:"cello",className:_.Z.artistResultListTitle},m.ag.get("playlist.curation.albums")),i.createElement(oe.Pv,{ariaLabel:m.ag.get("playlist.curation.albums"),renderRow:e,rowPlaceholder:oe.hU,nrTracks:n.length,tracks:n,resolveUri:e=>e.uri,columns:[oe.QD.TITLE,oe.QD.ALBUM,oe.QD.ADD]}))},je=({renderRow:e,searchResults:a})=>i.createElement(oe.Pv,{ariaLabel:m.ag.get("search.title.top-results"),renderRow:e,rowPlaceholder:oe.hU,nrTracks:a.length,tracks:a,resolveUri:e=>e.uri,columns:[oe.QD.TITLE,oe.QD.ALBUM,oe.QD.ADD]}),He=({renderRow:e,searchResults:a})=>i.createElement(oe.Pv,{ariaLabel:m.ag.get("search.title.top-results"),renderRow:e,rowPlaceholder:oe.hU,nrTracks:a.length,tracks:a,resolveUri:e=>e.uri,columns:[oe.QD.TITLE,oe.QD.ALBUM,oe.QD.ADD]}),Je=({renderRow:e,searchResults:a})=>i.createElement(oe.Pv,{ariaLabel:m.ag.get("search.title.top-results"),renderRow:e,rowPlaceholder:oe.hU,nrTracks:a.length,tracks:a,resolveUri:e=>e.uri,columns:[oe.QD.TITLE,oe.QD.ALBUM,oe.QD.ADD]});var $e=t(70325);const Ye="Gt26Myd3dsGrVxW9ArZW",ea="MLeLx_C7OnluWx8e9S88",aa="p8hNoO_LkxYLrEJ2cCSF",ta="FETh66aSunr0whiLsmk4",ia="KAuXIg8XQPSRMRqTjvAD",na="NB2fhkFoxu_ZCQlzHhha",la="saXvuHxalPYz3i36v1Ve",sa="DhMJGiOreiPrq04sm2AF",ra="gkgL9fB_pyDL75m9HKdu",da=({searchResult:e,index:a,isRTL:t,onClick:n})=>{const l=e.coverArt?.sources[0].url;return i.createElement($e.RX,{className:ia,rowIndex:a,"aria-selected":!1},i.createElement("div",{"aria-label":`${m.ag.get("artist-page.tracks.seemore")} ${e.name}`,className:ra,onClick:n},i.createElement($e.id,{columnIndex:0,className:na},void 0!==l?i.createElement("img",{className:aa,src:e.coverArt.sources[0].url,alt:e.name}):null,i.createElement("div",{className:la},i.createElement(d.D,{as:"p",className:ta,variant:"ballad"},e.name),i.createElement(d.D,{as:"p",variant:"mesto",semanticColor:"textSubdued"},m.ag.get("album")))),i.createElement($e.id,{columnIndex:1}),i.createElement($e.id,{columnIndex:2},i.createElement("button",{"data-testid":"top-bar-forward-button","aria-label":`See more from ${e.name}`,className:sa,onClick:n},t?i.createElement(Ce.e,null):i.createElement(Te.V,null)))))};var ca=t(39278);const oa=({size:e})=>i.createElement("div",{className:ea},i.createElement(ca.a,{iconSize:e})),ma=({searchResult:e,index:a,isRTL:t,onClick:n})=>{const l=e.visuals.avatarImage?.sources[0].url;return i.createElement($e.RX,{className:ia,rowIndex:a,"aria-selected":!1},i.createElement("div",{"aria-label":`${m.ag.get("artist-page.tracks.seemore")} ${e.profile.name}`,className:ra,onClick:n,"data-testid":"playlist-inline-curation-artist"},i.createElement($e.id,{columnIndex:0,className:na},void 0!==l?i.createElement("img",{className:Ye,src:l,alt:e.profile.name}):i.createElement(oa,{size:16}),i.createElement("div",{className:la},i.createElement(d.D,{as:"p",className:ta,variant:"ballad"},e.profile.name),i.createElement(d.D,{as:"p",variant:"mesto",semanticColor:"textSubdued"},m.ag.get("artist")))),i.createElement($e.id,{columnIndex:1}),i.createElement($e.id,{columnIndex:2},i.createElement("button",{"data-testid":"top-bar-forward-button","aria-label":`See more from ${e.profile.name}`,className:sa,onClick:n},t?i.createElement(Ce.e,null):i.createElement(Te.V,null)))))},ua=({episode:{uid:e,uri:a,name:t,imgUrl:n,podcast:l,isPlayable:s,isMOGEFRestricted:r,isExplicit:d},contextUri:c,index:o,usePlayContextItem:m})=>i.createElement(oe.YK,{uid:e,uri:a,isPlayable:s,isMOGEFRestricted:r,isExplicit:d,contextUri:c,name:t,imgUrl:n,index:o,podcast:l,usePlayContextItem:m}),ka=({label:e,index:a,isRTL:t,onClick:n})=>i.createElement($e.RX,{className:ia,rowIndex:a,"aria-selected":!1},i.createElement("div",{"aria-label":e,className:ra,onClick:n},i.createElement($e.id,{columnIndex:0,className:na},i.createElement(d.D,{as:"p",className:ta,variant:"ballad"},e)),i.createElement($e.id,{columnIndex:1}),i.createElement($e.id,{columnIndex:2},i.createElement("button",{"data-testid":"top-bar-forward-button","aria-label":e,className:sa,onClick:n},t?i.createElement(Ce.e,null):i.createElement(Te.V,null))))),pa=({track:{uid:e,uri:a,album:t,name:n,artists:l,isPlayable:s,isExplicit:r,isMOGEFRestricted:d},contextUri:c,index:o,usePlayContextItem:m})=>i.createElement(oe.cp,{uid:e,uri:a,isPlayable:s,isMOGEFRestricted:d,isExplicit:r,contextUri:c,name:n,imgUrl:t.imgUrl,index:o,album:t,artists:l,usePlayContextItem:m});let va;!function(e){e[e.SEARCH=0]="SEARCH",e[e.ALBUM=1]="ALBUM",e[e.ARTIST=2]="ARTIST",e[e.PODCAST=3]="PODCAST",e[e.PLAYLIST=4]="PLAYLIST",e[e.ALBUMRESULTS=5]="ALBUMRESULTS",e[e.ARTISTRESULTS=6]="ARTISTRESULTS",e[e.PODCASTRESULTS=7]="PODCASTRESULTS",e[e.EPISODERESULTS=8]="EPISODERESULTS",e[e.TRACKRESULTS=9]="TRACKRESULTS"}(va||(va={}));const Sa=(e,a)=>"GO_BACK"===a.type?1===e.breadcrumbs.length?e:e={...e,breadcrumbs:e.breadcrumbs.slice(0,e.breadcrumbs.length-1)}:"NAV_TO_ENTITY"===a.type?e={...e,breadcrumbs:[...e.breadcrumbs,a.level]}:("NAV_TO_RESULTS"===a.type?e={...e,breadcrumbs:[...e.breadcrumbs,a.level]}:"CHANGE_TERM"===a.type&&(e={term:a.term,breadcrumbs:[{navType:va.SEARCH,term:a.term,title:""}]}),e),ya=({resultList:e,level:a,isRTL:t,playlistUri:n,navToResults:l,navToEntity:s,term:c})=>{let o=e;const u=(e=>e.filter((({uri:e})=>r().isTrack(e)||r().isEpisode(e))).map((({uri:e,uid:a})=>({type:r().isTrack(e)?ze.p.TRACK:ze.p.EPISODE,uri:e,uid:a,provider:null}))))(e),{usePlayContextItem:k}=(0,ae.n)({uri:`${n.replace("spotify:","spotify:internal:recs:")}:${encodeURIComponent(c)}:${a?.navType??0}`,pages:[{items:u}]},{featureIdentifier:"search"}),p=(0,i.useCallback)(((e,a)=>e?void 0!==e.profile?i.createElement(ma,{isRTL:t,index:a,key:e.uri,searchResult:e,onClick:()=>{s({navType:va.ARTIST,uri:e.uri,title:e.profile.name})}}):void 0!==e.podcast?i.createElement(ua,{key:e.uri,index:a,episode:e,contextUri:n.replace("spotify:","spotify:internal:recs:"),usePlayContextItem:k}):void 0!==e.album?i.createElement(pa,{key:e.uri,index:a,track:e,contextUri:n.replace("spotify:","spotify:internal:recs:"),usePlayContextItem:k}):e.isSeeAllXRow?i.createElement(ka,{isRTL:t,index:a,label:e.label,key:e.uri,onClick:()=>{l({navType:e.type,term:c,title:e.label})}}):e.uri.includes("album")?i.createElement(da,{index:a,key:e.uri,isRTL:t,searchResult:e,onClick:()=>{s({navType:va.ALBUM,uri:e.uri,title:e.name})}}):null:null),[t,s,l,n,c,k]);if(""===c)return i.createElement("div",{className:_.Z.emptySearchTermContainer});if(!e||0===e?.length)return i.createElement("div",{className:_.Z.emptyStateContainer},i.createElement(d.D,{as:"h1",variant:"canon"},m.ag.get("search.empty-results-title",c)),i.createElement(d.D,{as:"p",variant:"mesto"},m.ag.get("search.empty-results-text")));if(a?.navType===va.SEARCH){const a=[{type:va.ARTISTRESULTS,label:m.ag.get("playlist.curation.see_all_artists"),isSeeAllXRow:!0,uri:"spotify:internal:recs:see-all-artists"},{type:va.ALBUMRESULTS,label:m.ag.get("playlist.curation.see_all_album"),isSeeAllXRow:!0,uri:"spotify:internal:recs:see-all-albums"},{type:va.TRACKRESULTS,label:m.ag.get("playlist.curation.see_all_songs"),isSeeAllXRow:!0,uri:"spotify:internal:recs:see-all-songs"}];return o=[...e,...a],i.createElement(qe,{renderRow:p,searchResults:o})}return a?.navType===va.ALBUM?i.createElement(We,{renderRow:p,searchResults:o}):a?.navType===va.ARTIST?i.createElement(Xe,{renderRow:p,searchResults:o}):a?.navType===va.ALBUMRESULTS?i.createElement(je,{renderRow:p,searchResults:o}):a?.navType===va.TRACKRESULTS?i.createElement(He,{renderRow:p,searchResults:o}):a?.navType===va.ARTISTRESULTS?i.createElement(Je,{renderRow:p,searchResults:o}):null},ba=({playlistUri:e,onCurationModeChange:a})=>{const[t,l]=(0,i.useState)([]),[s,c]=(0,i.useState)(),o=(0,n.v9)((e=>e.ui.textDirection.isRTL)),{level:u,changeTerm:k,goBack:p,navToEntity:v,navToResults:S,term:y}=(()=>{const[e,a]=(0,i.useReducer)(Sa,{term:"",breadcrumbs:[]}),{breadcrumbs:t,term:n}=e;return{changeTerm:e=>{a({type:"CHANGE_TERM",term:e})},level:t[t.length-1]||null,goBack:()=>{a({type:"GO_BACK"})},navToEntity:e=>{a({type:"NAV_TO_ENTITY",level:e})},navToResults:e=>{a({type:"NAV_TO_RESULTS",level:e})},term:n}})(),{request:b}=(0,i.useContext)(Re.Ax),g=(0,i.useCallback)((async e=>(await b(Ae,{term:e}))?.data.search||null),[b]),N=(0,i.useCallback)((async e=>(await b(Ie,{uri:e,offset:0,limit:100}))?.data.album||null),[b]),E=(0,i.useCallback)((async e=>(await b(Le,{uri:e,offset:0,limit:100}))?.data.artist||null),[b]);return(0,i.useEffect)((()=>{let e=!0;return(async()=>{var a;if(u)switch(u.navType){case va.SEARCH:try{if(!s||s.query!==y&&""!==y){const a=await g(y);e&&c(a)}else""===y&&l([])}catch{l([])}if(s){const e=(e=>{const a=e?.topResults?.items??[];return a.length?a.reduce(((a,t)=>{const i=t.uri,n=r().from(i);if(i&&n)switch(r().from(i)&&r().from(i).type){case r().Type.ALBUM:{const t=((e,a)=>a.find((a=>a.uri===e)))(i,e?.albums?.items||[]);t&&a.push(t);break}case r().Type.ARTIST:{const t=((e,a)=>a.find((a=>a.uri===e)))(i,e?.artists?.items||[]);t&&a.push(t);break}case r().Type.TRACK:{const t=((e,a)=>a.find((a=>a.track.uri===e)))(i,e?.tracks?.items||[]);t&&a.push(Ge(t));break}case r().Type.EPISODE:{const t=((e,a)=>a.find((a=>a.episode.uri===e)))(i,e?.episodes?.items||[]);t&&a.push(Ke(t));break}}return a}),[]):[]})(s);l(e)}break;case va.ARTISTRESULTS:l(s?.artists?.items);break;case va.ALBUMRESULTS:l(s?.albums?.items);break;case va.TRACKRESULTS:{const e=s?.tracks?.items;e?.length&&l(e.map((e=>Ge(e))));break}case va.EPISODERESULTS:{const e=s?.episodes?.items;e?.length&&l(e.map((e=>Ke(e))));break}case va.ALBUM:try{const a=await N(u.uri);e&&l((e=>{const a={uri:e.uri,id:e.id,name:e.name,coverArt:e.coverArt};return e.tracks.items.map((e=>({...e,track:{...e.track,album:a}})))})(a).map((e=>Ge(e))))}catch{l([])}break;case va.ARTIST:try{const t=await E(u.uri);e&&l((a=t).discography?[...a.discography.topTracks.items.map((e=>Ge(e))),...a.discography.popularReleases.items.map((e=>{const{uri:a,name:t,coverArt:{sources:i}}=e.releases.items[0];return{uri:a,name:t,coverArt:{sources:i}}}))]:[])}catch{l([])}}})(),()=>{e=!1}}),[u,g,N,E,y,s]),i.createElement(i.Fragment,null,i.createElement("section",{className:_.Z.playlistInlineCurationSection},i.createElement("div",{className:_.Z.playlistInlineCurationWrapper},i.createElement(d.D,{as:"h1",className:_.Z.playlistInlineCurationTitle,variant:"canon"},m.ag.get("playlist.curation.title")),i.createElement(i.Suspense,{fallback:null},i.createElement(Qe,{placeholder:m.ag.get("playlist.curation.search_placeholder"),onFocus:()=>{a(!0)},onChange:e=>{k(e)}}))),i.createElement("button",{className:_.Z.playlistInlineCurationCloseButton,onClick:()=>a(!1)},i.createElement(Fe.k,{"aria-label":m.ag.get("close")}))),null!==u&&u.navType!==va.SEARCH?i.createElement("button",{className:_.Z.playlistInlineCurationBackButton,onClick:()=>p()},o?i.createElement(Te.V,{"aria-label":m.ag.get("navbar.go-back"),className:_.Z.icon}):i.createElement(Ce.e,{"aria-label":m.ag.get("navbar.go-back"),className:_.Z.icon}),i.createElement(d.D,{as:"p",variant:"cello"},u.title)):null,i.createElement("div",{className:_.Z.searchResultListContainer,"data-testid":"playlist-inline-curation-results"},i.createElement(ya,{playlistUri:e,term:y,level:u,resultList:t,navToEntity:v,navToResults:S,isRTL:o})))};var ga=t(98816),Na=t(98562),Ea=t(35213);const fa=i.memo((({metadata:e,tracklistDomRef:a})=>{const{hasEpisodes:t,isCollaborative:n,formatListData:l,hasDateAdded:s,collaborators:r}=e,d="chart"===l?.type,c="live-streams"===l?.type,o=["blend","celebrity-blend","friends-mix"].indexOf(l?.type||"")>-1,u=!!t,{spec:k,logger:p}=(0,ce.fU)(ga.createDesktopSearchBarEventFactory,{}),v=(0,i.useCallback)((()=>{p.logInteraction(k.filterFieldFactory().keyStrokeFilter())}),[p,k]),S=(0,i.useCallback)((()=>{p.logInteraction(k.filterFieldFactory().hitClearFilter())}),[p,k]),y=(0,i.useCallback)((()=>{p.logInteraction(k.sortButtonFactory().hitSort())}),[p,k]),b=(0,i.useMemo)((()=>((e,a,t,i,n,l,s)=>e?B.RJ:(0,M.RG)(a,t,i,n,l,s))(d,n,u,s,c,o,r?.count??1)),[d,n,u,s,c,o,r]);return i.createElement("div",{className:_.Z.searchBoxContainer},i.createElement(i.Suspense,{fallback:null},i.createElement(Na.K,{placeholder:m.ag.get("playlist.search_in_playlist"),onFilter:v,onClear:S,clearOnEscapeInElementRef:a})),i.createElement(Ea.l,{columns:b,onSort:y}))}));var ha=t(61728),Fa=t(82760);const Ta="multiUserAttributionDisplayNamesV2";var Ca=t(59916);function Ra(e){return(0,Ca.MW)(e)||(0,Ca.JF)(e)}const Aa=new Set(B.zq),Ia=new Set([]),La=i.memo((function({ariaLabel:e,nrTracks:a,playlistUri:t,playlistName:l,isCollaborative:s,isMixedMedia:d,isLive:c,isBlend:o,hasDateAdded:k,canEdit:p,scrollToUid:v,feedbackPath:S,deleteFeedbackPath:y,usePlayContextItem:b,tracklistRef:g,tracklistDomRef:N,nrCollaborators:E=1,canRemove:f,spec:h,initialItems:F}){const T=(0,ce.$P)(),C=(0,i.useContext)(te.ZF),{filter:R}=(0,i.useContext)(O.fo),{sortState:A,setSortState:I}=(0,i.useContext)(B.Gb),[L,D]=(0,i.useState)(a),U=(0,i.useRef)((()=>{})),[x,P]=(0,i.useState)([]),w=(0,i.useRef)({}),_=(0,n.I0)(),V=(0,i.useCallback)((()=>{g?.current&&g.current.update()}),[g]);(0,le.r)(t,V);const Q=(0,i.useCallback)(((e,a)=>{I((0,M.VK)(e,A)),T.logInteraction(h.columnHeaderFactory({identifier:e,position:a||0}).hitSort())}),[I,A,T,h]),Z=(0,i.useCallback)((e=>{U.current(),C.remove(t,e)}),[C,t]),G=(0,i.useCallback)(((e,a,t=!1)=>{f&&(U.current=a,e.length>1&&!t?P(e):Z(e))}),[f,Z]);(0,i.useEffect)((()=>{g?.current&&g.current.update()}),[A,R,g]),(0,i.useEffect)((()=>{g?.current&&v&&g.current.scrollToItem({uid:v})}),[v,g]),(0,i.useEffect)((()=>{g?.current&&""===R&&g.current.scrollToFirstSelected()}),[R,L,g]),(0,i.useEffect)((()=>{D(a)}),[a]);const K=(0,i.useCallback)((async(e,a)=>{const i=await C.getContents(t,{offset:e,limit:a,sort:(0,M._j)(A),filter:R,decorateFormatListData:!!S||c||o}),n=i.items.filter(((a,t)=>null!==a||(w.current[t+e]=!0,!1))),l=Object.keys(w.current).length;return i.totalLength-l!==L&&D(i.totalLength-l),n}),[t,C,L,A,R,S,c,o]),q=(0,i.useCallback)(((e,a,i)=>{if(!g?.current)return;const n=g.current.getRows();n[a].id&&(T.logInteraction(h.dragSort()),i===Fa.W.Before?C.move(t,e,{before:n[a].id}):C.move(t,e,{after:n[a].id}))}),[g,T,h,C,t]),W=(0,i.useCallback)(((e,a,i)=>{if(!g?.current)return;const n=g.current.getRows();n[a].id&&(T.logInteraction(h.dragAddToPlaylist({playlist:t,itemToBeAdded:e[0]})),i===Fa.W.Before?_((0,u.jV)(t,e,{before:n[a].id})):_((0,u.jV)(t,e,{after:n[a].id})))}),[g,T,h,t,_]),X=(0,i.useCallback)((()=>{C.resync(t)}),[C,t]),j=(0,i.useCallback)(((e,a)=>{let n,l;const m=!!(0,Ca.JF)(e)&&e.podcastSubscription.isUserSubscribed;(0,Ca.JF)(e)?(n=e.show,l=e.images.concat(e.show.images)):(0,Ca.MW)(e)&&(n=e.album,l=e.album?.images);const u=(0,ue.X)(l,{desiredSize:40,desiredLabel:"small"});let k=[];p&&A.order===oe.kn.NONE&&(k=[z.aN[r().Type.TRACK],z.aN[r().Type.LOCAL],z.aN[r().Type.EPISODE]]);const v="1"===e?.formatListAttributes?.["dislike-feedback-selected"];let g=!1;(0,Ca.JF)(e)&&e.podcastSubscription.isPaywalled&&!m?g=!0:Ra(e)&&(g=e.isPlayable&&!v);const N=o&&((e,a)=>{const t=[];if(!a)return t;const i=a?.[a[Ta]?Ta:"multiUserAttributionDisplayNames"]?.split(","),n=a?.multiUserAttributionImages?.split(",");if(!i||!n)return t;const l=a?.multiUserAttributionUsernamesV2?.split(",")||[],s=a?.multiUserAttributionType?.split(",")||[],d=i.length;for(let e=0;e<d;e++){const a=l[e],d=a&&r().profileURI(a).toURI();t.push({username:a,uri:d,displayName:i[e],images:(c=n[e],c.length>1?[{url:c}]:[]),recsplanation:s[e]})}var c;return t.sort(((a,t)=>a.username?a.username===e?.username?-1:t.username===e?.username?1:0:0))})(e.addedBy,e?.formatListAttributes)||e.addedBy&&[e.addedBy]||[];return i.createElement(oe.dx,{key:a+e.uri,index:a,playIndex:e.playIndex??void 0,contextUri:t,uri:e.uri,uid:e.uid??void 0,id:e.id,isPlayable:g,duration_ms:Ra(e)?e.duration.milliseconds:0,isPaywalled:!!(0,Ca.JF)(e)&&e.podcastSubscription.isPaywalled,isUserSubscribed:m,name:Ra(e)?e.name:"",artists:(0,Ca.MW)(e)?e.artists:void 0,albumOrShow:n,isExplicit:(0,Ca.MW)(e)&&e.isExplicit,isCollaborative:s,nrCollaborators:E,isMixedMedia:d,isLocal:(0,Ca.MW)(e)&&e.isLocal,addedBy:N,hasDecoratedAddedBy:C.getCapabilities().canDecorateAddedBy,dateAdded:e.addedAt,release_date:(0,Ca.JF)(e)&&e.release.date||"",isMOGEFRestricted:(0,Ca.MW)(e)&&e.is19PlusOnly,type:e.type,imgUrl:u?.url||"",onMove:q,onInsert:W,usePlayContextItem:b,allowedDropTypes:k,feedbackPath:S,feedbackUri:e?.formatListAttributes?.feedback_uri,deleteFeedbackPath:y,isDisliked:v,isLive:c,isBlend:o,ticketingSiteURL:e?.formatListAttributes?.ticketingSite,eventDate:e?.formatListAttributes?.eventDate,canRemove:f,onFeedbackClick:X})}),[p,f,A,t,s,E,d,C,q,W,b,S,y,c,o,X]);return i.createElement(i.Fragment,null,i.createElement(me.ZP,{value:"playlist-tracklist"},i.createElement(oe.Pv,{testID:"playlist-tracklist",key:t,ariaLabel:e,hasHeaderRow:!0,columns:(0,M.RG)(s,d,k,c,o,E),sortableColumns:C.getCapabilities().canSort?Aa:Ia,sortState:A,onSort:Q,onRemove:G,renderRow:j,resolveUri:e=>e.uri,resolveUid:e=>e.id,nrTracks:L,fetchTracks:K,limit:100,canFetchAllTracks:C.getCapabilities().canFetchAllTracks,outerRef:g,outerDomRef:N,tracks:F.filter(Boolean)})),i.createElement(ha.h,{title:m.ag.get("playlist.remove_from_playlist",l),isOpen:x.length>0,tracks:x,onClose:e=>{e.stopPropagation(),P([])},onRemove:Z}))}));var Da=t(86025),Ua=t(27826),xa=t(61634);const Pa=i.memo((function({playlistUri:e,playlistLength:a}){const{tracks:t,refresh:n}=((e,a=10)=>{const t=2*a,n=3*a,l=(0,i.useRef)(0),[s,r]=(0,i.useState)(e),[d,c]=(0,i.useState)([]),m=(0,i.useRef)([]),u=(0,i.useContext)(ne.Z),{spec:k,logger:p}=(0,ce.fU)(o.createDesktopPlaylistEventFactory,{data:{uri:e}}),v=i.useMemo((()=>k.recommendedFactory()),[k]);(0,i.useEffect)((()=>{const a=u.getEvents(),t=a=>{a.data.uri===e&&c((e=>e.filter((e=>a.data.items.every((a=>a.uri!==e.uri))))))};return a.addListener(xa.XL.OPERATION_COMPLETE,t),()=>{a.removeListener(xa.XL.OPERATION_COMPLETE,t)}}),[u,e]),(0,i.useEffect)((()=>(c([]),r(e),m.current=[],l.current=l.current+1,()=>{l.current=l.current+1})),[e]),(0,i.useEffect)((()=>{if(d.length<t){const e=Math.min(t,n-d.length),a=l.current;u.getRecommendedTracks(s,m.current,e).then((t=>{if(a!==l.current)return;const i=t.map((e=>e?.uri&&Ua.o.from(e.uri).id)).filter((e=>null!==e));t.length<e&&m.current.length?m.current=[]:m.current=[...m.current,...i],c((e=>[...e,...t]))}))}}),[t,n,u,s,d.length]);const S=(0,i.useCallback)((()=>{if(k){const e=v.refreshButtonFactory().hitRefreshContent();p.logInteraction(e)}c((e=>e.slice(a)))}),[p,v,k,a]);return{tracks:d.slice(0,a),_bufferedTracks:d.slice(a),refresh:S}})(e),l=!a||0===a,{usePlayContextItem:s}=(0,ae.n)({uri:e.replace("spotify:","spotify:internal:recs:"),pages:[{items:t.map((e=>({...e,provider:null,type:ze.p.TRACK,uid:null})))}]},{featureIdentifier:"playlist_recommendations"}),r=(0,i.useCallback)(((a,t)=>i.createElement(oe.cp,{key:a.uri,index:t,imgUrl:a.album.imageUrl,contextUri:e.replace("spotify","spotify:internal:recs"),uri:a.uri,isPlayable:!a.isMOGEFRestricted,name:a.name,artists:a.artists,album:{...a.album,imgUrl:a.album.imageUrl},isExplicit:a.explicit,isMOGEFRestricted:a.isMOGEFRestricted,usePlayContextItem:s})),[e,s]),c=(0,i.useMemo)((()=>[oe.QD.TITLE,oe.QD.ALBUM,oe.QD.ADD]),[]),u=(0,i.useCallback)((e=>e.uri),[]),k=(0,i.useCallback)((e=>e.id),[]),p=(0,i.useMemo)((()=>t.slice(0,Math.min(t.length,10))),[t]);return t.length>0?i.createElement("div",{className:_.Z.recommendedTrackList},i.createElement("div",{className:_.Z.top},i.createElement("div",{className:_.Z.header},i.createElement(d.D,{variant:"canon"},m.ag.get("playlist.extender.recommended.title")),i.createElement(d.D,{variant:"mesto",className:_.Z.subtitle},l?m.ag.get("playlist.extender.title.in.playlist"):m.ag.get("playlist.extender.songs.in.playlist")))),t.length?i.createElement(i.Fragment,null,i.createElement(oe.Pv,{ariaLabel:m.ag.get("playlist.extender.recommended.header"),key:`${e}-recommended`,nrTracks:Math.min(t.length,10),rowPlaceholder:oe.hU,tracks:p,renderRow:r,resolveUri:u,resolveUid:k,columns:c}),i.createElement(Da.oM,{className:_.Z.refreshButton,onClick:n},m.ag.get("playlist.extender.refresh"))):null):null})),wa=i.lazy((()=>Promise.all([t.e(1814),t.e(2716),t.e(7405)]).then(t.bind(t,82716)))),_a=i.memo((function({playlist:e,capabilities:a}){const{metadata:{uri:t,name:s,images:k,totalLength:p,isOwnedBySelf:v,isCollaborative:S,hasEpisodes:C,hasSpotifyTracks:R,canAdd:I,canRemove:L,canPlay:D,formatListData:x,hasDateAdded:Z,collaborators:te},contents:{items:ne}}=e,{spec:le,logger:se,UBIFragment:re}=(0,ce.fU)(o.createDesktopPlaylistEventFactory,{data:{uri:t}}),de=i.useMemo((()=>le.headerFactory()),[le]),oe=i.useMemo((()=>le.tracklistFactory()),[le]),me="chart"===x?.type,ue="live-streams"===x?.type,ke=["blend","celebrity-blend","friends-mix"].indexOf(x?.type||"")>-1,pe=!!C,ve=x?.attributes||{},ye=ve.header_image_url_desktop||ve.image_url||null,be=I&&L,{inlineCurationModeIsOn:ge,handleInlineCurationModeChange:Ne}=((e,a)=>{const t=(0,c.W6)(j.pg),[n,l]=(0,i.useState)(e&&0===a&&t),{scrollNodeChildRef:s}=(0,i.useContext)(ee.VX),r=(0,i.useRef)(n);return(0,i.useEffect)((()=>{const e=!r.current;s&&e&&n&&s.current?.scrollIntoView({block:"end",behavior:"smooth"}),r.current=n}),[s,n]),{inlineCurationModeIsOn:n,handleInlineCurationModeChange:e=>{l(e)}}})(be,p),Ee=a.canFilter&&p>0,Fe=a.canSort&&p>0,Te=(0,K.k)(),Ce=Te&&p>0,{productState:Re}=(0,n.v9)(H.Gg),Ae=!!Re&&parseInt(Re.ads,10)>0,Ie=(0,n.I0)(),Le=(0,l.k6)(),De="POP"!==Le.action?new URLSearchParams(Le.location.search).get("uid"):null,[Ue,xe]=(0,A.Z)(t),Pe=(0,G.o)(),{filter:we}=(0,i.useContext)(O.fo),{sortState:_e}=(0,i.useContext)(B.Gb),Me=(0,i.useRef)(null),Oe=(0,i.useRef)(null),[Be]=k,Ve=(0,q.Z)(null!==ye?ye:Be?.url||null),Qe=i.useMemo((()=>le.actionBarFactory()),[le]),{isPlaying:Ze,isActive:ze,togglePlay:Ge,usePlayContextItem:Ke}=(0,ae.n)((0,ie.U)(t,(0,M._j)(_e),we),{featureIdentifier:"playlist"}),qe=(0,i.useCallback)((()=>{const e=(0,X.aK)({isPlaying:Ze,isActive:ze,spec:Qe.playButtonFactory(),logger:se,uri:t});Ge({loggingParams:e})}),[Ze,ze,Ge,Qe,se,t]),We=(0,i.useCallback)((async()=>{Pe({targetUri:t,intent:Ue?"unsave":"save",type:"click"});try{await xe(!Ue)}catch{}}),[Ue,Pe,xe,t]),Xe=(0,i.useCallback)((()=>{const e=Qe.shareButtonFactory().hitShare({entityToBeShared:t,shareId:""});se.logInteraction(e)}),[Qe,se,t]),je=(0,i.useCallback)((()=>{let e;const a=Qe.heartButtonFactory();e=Ue?a.hitRemoveLike({itemNoLongerLiked:t}):a.hitLike({itemToBeLiked:t}),se.logInteraction(e),We()}),[Qe,We,Ue,se,t]),He=(0,i.useCallback)((e=>{const a=e.split(/[\r\n]+/g).map((e=>r().from(e))).filter((e=>r().isTrack(e)||r().isEpisode(e)||r().isLocalTrack(e)));if(a.length>0&&I){const e=a.map((e=>e.toURI())),i=Me.current?.getSelected()?.slice(-1)?.[0],n={after:i?.uid||"end"};Ie((0,u.jV)(t,e,n))}}),[I,Ie,t]);(0,W.aw)(He);const Je=(0,i.useCallback)(((e,a)=>{const i=[...a[z.aN[r().Type.TRACK]]||[],...a[z.aN[r().Type.LOCAL]]||[],...a[z.aN[r().Type.EPISODE]]||[],...a[z.aN[r().Type.ALBUM]]||[]];i.length>0&&I&&(se.logInteraction(le.dragAddToPlaylist({playlist:t,itemToBeAdded:i[0]})),Ie((0,u.jV)(t,i)),Pe({targetUri:t,intent:"add",type:"drop"}))}),[I,se,le,t,Ie,Pe]);return i.createElement(i.Suspense,{fallback:null},i.createElement(h.$,null,m.ag.get("playlist.page-title",s)),i.createElement(f.Z,{types:[z.aN[r().Type.TRACK],z.aN[r().Type.LOCAL],z.aN[r().Type.EPISODE],z.aN[r().Type.ALBUM]],onDrop:Je},i.createElement("section",{role:"presentation",className:_.Z.playlist,"data-testid":"playlist-page","data-test-uri":t},i.createElement(he.s,{metadata:e.metadata,isPlaying:Ze,togglePlay:qe,backgroundColor:Ve,spec:de}),i.createElement("div",{className:_.Z.playlistContent},i.createElement(b.o,{backgroundColor:Ve},i.createElement(b.F,null,D?i.createElement(w.$,{onClick:qe,isPlaying:Ze,size:$.qE.lg,uri:t,ariaPlayLabel:m.ag.get("playlist.a11y.play",s),ariaPauseLabel:m.ag.get("playlist.a11y.pause",s)}):null,v&&R&&i.createElement(Q.v,{uri:t,renderEnabled:()=>i.createElement(V.v,{uri:t})}),v?null:i.createElement(T.r,null,i.createElement(J.H,{isAdded:!!Ue,onClick:je,size:J.q.md})),i.createElement(g.o,{uri:t,isFollowing:!!Ue,canDownload:Ce,onClick:(e,a)=>(0,X.l7)(a,Qe.downloadButtonFactory(),se,t),onFollow:We,size:g.q.md}),i.createElement(P.F,{property:j.bM,renderNewExperience:()=>e.metadata.permissions?.canAdministratePermissions?i.createElement(fe,{onClick:Xe,label:m.ag.get("permissions.invite-collaborators",s),uri:t}):null}),i.createElement(Y.y,{onShow:()=>(0,X.qq)(Qe,se),menu:i.createElement(E.X,{uri:t})},i.createElement(N.z,{label:m.ag.get("more.label.context",s)})),Ee&&Fe&&i.createElement(re,{spec:Qe},i.createElement(fa,{metadata:e.metadata,tracklistDomRef:Oe})))),i.createElement("div",{className:"contentSpacing"},Ae?i.createElement(y,{playlistUri:t}):null,p>0?i.createElement(i.Suspense,{fallback:null},i.createElement(re,{spec:oe},me?i.createElement(Se,{key:t,ariaLabel:s,nrTracks:p,playlistUri:t,rankType:ve.rank_type||"",scrollToUid:De,usePlayContextItem:Ke,tracklistDomRef:Oe}):i.createElement(La,{key:t,ariaLabel:s,nrTracks:p,playlistUri:t,playlistName:s,hasDateAdded:Z,isCollaborative:S,isMixedMedia:pe,isLive:ue,isBlend:ke,canEdit:be,scrollToUid:De,feedbackPath:ve["dislike-endpoint"],deleteFeedbackPath:ve["delete-endpoint"],usePlayContextItem:Ke,tracklistRef:Me,tracklistDomRef:Oe,nrCollaborators:te?.count,canRemove:L,spec:oe,initialItems:ne}))):i.createElement(i.Suspense,{fallback:null},i.createElement(P.F,{property:j.pg,renderNewExperience:()=>null,renderOldExperience:()=>i.createElement(F.u,{message:m.ag.get("playlist.empty_state_subtitle"),title:m.ag.get("playlist.empty_state_title"),linkTo:"/browse/newreleases",linkTitle:m.ag.get("browse.new-releases"),renderInline:!0},i.createElement(U.Z,null))})),v?i.createElement(i.Suspense,{fallback:null},i.createElement(P.F,{property:j.pg,renderNewExperience:()=>ge?i.createElement(ba,{playlistUri:t,onCurationModeChange:Ne}):i.createElement("button",{className:_.Z.seeMore,onClick:()=>{Ne(!0)}},i.createElement(d.D,{as:"div",variant:"minuetBold"},m.ag.get("playlist.curation.find_more"))),renderOldExperience:()=>null})):null,be&&!ge&&Te?i.createElement(Pa,{playlistUri:t,playlistLength:e.metadata.totalLength}):null)))))})),Ma=i.memo((function({uri:e}){const{search:a}=(0,l.TH)(),t=(0,c.W6)(j.bM),s=(0,i.useContext)(te.ZF).getCapabilities(),{isAnonymous:r}=(0,n.v9)(H.Gg),{isEnhanced:d}=(0,Z.U)(e),{filter:o}=(0,i.useContext)(O.fo),{sortState:u}=(0,i.useContext)(B.Gb),k=((e,a,t)=>{const n=(0,i.useContext)(ne.Z),l=(0,se.useQueryClient)(),s=(0,i.useRef)(a?.withSync),r=(0,re.jP)((()=>["usePlaylist",e,a,t]),[e,a,t]),{data:d}=(0,se.useQuery)(r(),(()=>n.getPlaylist(e,{...a,withSync:s.current},t)),{cacheTime:36e5,keepPreviousData:!0}),c=(0,i.useCallback)((()=>{s.current=!1,l.invalidateQueries(r())}),[l,r]);return(0,le.r)(e,c),d??null})(e,{decorateFormatListData:!0,withSync:!0,hydrateCollaboratorsWithMembers:t},{offset:0,limit:25,sort:(0,M._j)(u),filter:o});return(0,i.useEffect)((()=>{const t=new URLSearchParams(a).get("prid");if(!r&&t){const a=`https://spclient.wg.spotify.com/algotorial-sharing-service/v1/shared?playlistId=${e}&sharedEntityUri=${t}`;(0,de.k)().request(a,{method:"POST",authorize:!0,allowOffline:!0})}}),[e,r,a]),k?k.metadata.permissions&&!k.metadata.permissions.canView?i.createElement(D,{uri:e}):i.createElement(Q.v,{uri:e,renderEnabled:()=>d?i.createElement(i.Suspense,{fallback:null},i.createElement(wa,{metadata:k.metadata,capabilities:s,featureIdentifier:"playlist"})):i.createElement(_a,{playlist:k,capabilities:s}),renderDisabled:()=>i.createElement(_a,{playlist:k,capabilities:s})}):i.createElement(x.h,{hasError:!1,errorMessage:m.ag.get("error.not_found.title.playlist"),loadOffline:s.canModifyOffline})})),Oa=()=>{const{playlistId:e}=(0,l.UO)(),a=r().playlistV2URI((e||"").split("&")[0]).toURI();return i.createElement(B.kz,{uri:a},i.createElement(O.hz,{uri:a},i.createElement(Ma,{uri:a})))}}}]);
//# sourceMappingURL=xpui-routes-playlist.js.map