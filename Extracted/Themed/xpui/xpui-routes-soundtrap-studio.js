"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[3780],{22578:(e,t,n)=>{n.d(t,{$:()=>f});var r=n(67294),o=n(64593),s=n(96206),a=n(69691),c=n(8341),i=n(89952),l=n(51615),u=n(24183);function p(e){return e.includes("Spotify")?e:`Spotify – ${e}`}const f=({children:e,usePlayingItem:t})=>{let n=p(e);(e=>{const{mainLandmarkRef:t}=(0,u.Oh)(),n=(0,l.k6)(),o=n.location?.state?.preventMoveFocus,s=(0,r.useRef)(n.length<2);s.current=n.length<2,(0,r.useEffect)((()=>{const n=t.current;!o&&!s.current&&n&&e&&(n.setAttribute("aria-label",e),n.focus())}),[e,t,o])})(e);const{isPlaying:f}=(0,a.IK)(),d=(0,c.Y)((e=>e?.item));return d&&(f||t)&&((0,i.G_)(d)?n=[d.name,d.artists.map((e=>e.name)).join(s.ag.getSeparator())].join(" • "):(0,i.iw)(d)?n=[d.name,d.show.name].join(" • "):(0,i.k6)(d)&&(n=p(s.ag.get("ad-formats.advertisement")))),r.createElement(o.q,{defaultTitle:"Spotify",defer:!1},r.createElement("title",null,n))}},57345:(e,t,n)=>{n.r(t),n.d(t,{default:()=>y});var r=n(67294),o=n(94184),s=n.n(o),a=n(86706),c=n(51615),i=n(69518),l=n.n(i),u=n(96206),p=n(22578),f=n(6158),d=n(50709),m=n(67448);var w=n(99125),h=n(23716),g=n(8341);function k(e,t){const n=(0,m.z)();(0,r.useEffect)((()=>{const r=n.getEvents(),o=e=>t(e);return r.addListener(e,o),()=>{r.removeListener(e,o)}}),[e,n,t])}const I="_8NXEiIW8UUvsBVNhHdc",y=r.memo((()=>{const{projectId:e,songId:t}=(0,c.UO)(),n=(0,r.useRef)(null),o=(0,a.I0)(),i=(0,m.z)(),y=(0,c.k6)(),E=(0,r.useMemo)((()=>[["showtippopups",0],["workflow","cover"],["workflowSongId",t]].map((([e,t])=>`${e}=${t}`)).join("&")),[t]),b=(0,a.v9)((e=>e.session.user?.uri)),j=l().from(b).toURLPath(!0),[S,v]=(0,r.useState)(null),{route:$,error:U}=(({redirectUri:e})=>{const t=(0,m.z)(),[n,o]=(0,r.useState)(""),[s,a]=(0,r.useState)(null);return(0,r.useEffect)((()=>{(async()=>{try{const{token:n}=await t.requestAccountLinkToken();o(`https://www.soundtrap.com/spotify/accountlink/?redirect=${encodeURIComponent(e)}&token=${n}`)}catch(e){a("Something went wrong while trying link your account")}})()}),[t,e]),{route:n,error:s}})({redirectUri:`https://www.soundtrap.com/studio/${e}/?${E}`}),{resetMainView:L,collapseMainView:P}=(0,d.i)(),C=(0,h.g)(),M=(0,g.Y)((e=>e?.hasContext&&!e?.isPaused));(0,r.useEffect)((()=>{const e=n.current;return i.setIframe(e),()=>{i.setIframe(null)}}),[n,i,o]),k(w.O.EXIT,(()=>{y.goBack()})),k(w.O.PUBLISH,(async({data:e})=>{const t=!e.title||!e.projectId;if(v(null),t)v("Cannot publish project, title or projectId are missing.");else try{await i.publish({projectId:e.projectId,title:e.title}),y.push(j,{referrer:"soundtrap_publish",newProjectId:e.projectId})}catch(e){v("Something went wrong while trying to publish the project.")}})),(0,r.useEffect)((()=>{M&&C?.pause()}),[M,C]),(0,r.useEffect)((()=>(P(),L)),[]);const R=U??S;return R?r.createElement(f.h,{hasError:!0,errorMessage:R}):r.createElement(r.Suspense,{fallback:null},r.createElement(p.$,null,u.ag.get("playlist.page-title")),r.createElement("iframe",{ref:n,src:$,className:s()(I),allow:"microphone https://www.soundtrap.com/studio;",title:"Soundtrap"}))}))}}]);
//# sourceMappingURL=xpui-routes-soundtrap-studio.js.map