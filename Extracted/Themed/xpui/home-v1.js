"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[270],{70105:(e,t,n)=>{n.d(t,{n:()=>be});var a=n(67294),r=n(50114),o=n(69559),i=n(27937),l=n(42781),c=n(4236),s=n(13218),m=n(70296),u=n(87462),f=n(69518),d=n.n(f),E=n(24524),g=n(86250),h=n(39278),y=n(61251),p=n(96206),_=n(18261),v=n(4232),S=n(80507),T=n(25988),I=n(35410),b=n(86514),P=n(97081),w=n(20006),k=n(26010),A=n(69010),C=n(52759),B=n(69691);const N="view-homeShortcutsGrid-shortcuts",M="view-homeShortcutsGrid-grid",x="view-homeShortcutsGrid-shortcutLink",L="view-homeShortcutsGrid-shortcut",U="view-homeShortcutsGrid-draggable",R="view-homeShortcutsGrid-imageContainer",F="view-homeShortcutsGrid-imageWrapper",O="view-homeShortcutsGrid-image",D="CKxS_0I5yf3i15WAjzvE",W="view-homeShortcutsGrid-main",Z="view-homeShortcutsGrid-nameWrapper",H="view-homeShortcutsGrid-name",z="EzRmGRncgnv1zFgF4dqE",G="bPmmKmSPLKMhtJSaUJRX",J="vpQWUBWS_lXRLZMRJT7w",Y="GSv7K805J9Jw7LB9tn2A",$="view-homeShortcutsGrid-PlayButtonContainer",q="s9c9x_mJq197U2hBzGtV",K=a.memo((function({item:e}){const{useDownloading:t}=(0,a.useContext)(k.I),{currentAvailability:n}=t(e.uri),r=e.duration_ms??0,{isPlaying:o,isActive:i}=(0,B.$o)(e.uri),[l]=(0,C.z)(1e4,(t=>t.item?.uri===e.uri)),c=e.resume_point?.resume_position_ms??0,s=o||i?l:c,m=Math.round(100/(r/s)),u=n===A.V8.YES,f=r&&s>0;return u||f?a.createElement("div",{className:J},u?a.createElement(P.E,{iconSize:16,semanticColor:"textSubdued"}):null,f?a.createElement(w.k,{className:Y,value:m,semanticColor:"essentialBase"}):null):null}));var V=n(94184),j=n.n(V),X=n(51615),Q=n(32667),ee=n(43864),te=n(82627),ne=n(91355),ae=n(84242),re=n(54444),oe=n(57784),ie=n(56802),le=n(67892),ce=n(89104),se=n(49961);const me=a.memo((function({images:e=[],fallbackIcon:t=E.U}){const n=(0,se.X)(e),r=n?.url?F:D;return a.createElement("div",{className:R},a.createElement("div",{className:r},a.createElement(ce.E,{className:O,src:n?.url,loading:"lazy",testid:"shortcut-image"},a.createElement(t,{"aria-hidden":!0}))))})),ue=a.memo((function({index:e,item:t,fallbackIcon:n,showPlayButton:r,extraContent:o,onContextMenu:i=(()=>{}),onTouchStart:l=(()=>{}),onTouchEnd:c=(()=>{})}){const s=(0,X.k6)(),u=(0,ie.o)(),{setColorFromUri:f,resetColor:E,clearColor:g}=(0,m.WQ)(),h=(0,ne.G3)(t.uri,t.release_date,t.resume_point?.resume_position_ms,t.resume_point?.fully_played),{spec:y,logger:p}=(0,re.fU)(ee.createDesktopShortcutsPlayNavCardEventFactory,{data:{position:e,uri:t.uri}}),{isPlaying:_,isActive:v,togglePlay:S}=(0,ae.n)({uri:t.uri},{featureIdentifier:"home",referrerIdentifier:"home"});const T=(0,a.useCallback)((()=>{u({targetUri:t.uri,intent:"navigate",type:"click"});const e=y.hitUiNavigate({destination:t.uri});p.logInteraction(e),s.push(d().from(t.uri).toURLPath(!0))}),[s,t.uri,p,u,y]),I=(0,a.useCallback)((()=>{f(t.uri)}),[t.uri,f]);(0,a.useEffect)((()=>()=>{g()}),[g]);const b=(0,re.Wi)(y),P=(0,oe.O1)([t.uri],t.name);return a.createElement("div",{ref:b,className:L,onContextMenu:i,onTouchStart:l,onTouchEnd:c,onMouseEnter:I,onMouseLeave:E},a.createElement("div",{className:U,onDragStart:P},a.createElement(me,{images:t.images,fallbackIcon:n}),a.createElement("div",{className:W},a.createElement("div",{className:Z},a.createElement("div",{className:H},h&&a.createElement(ne.Rd,{className:G}),a.createElement(le.r,{to:t.uri,onClick:T,title:t.name},a.createElement(Q.D,{as:"p",variant:"balladBold",className:z},t.name))),o||null),r&&a.createElement("div",{className:j()($,{[q]:_})},a.createElement(te.fh,{isPlaying:_,onClick:function(){u({targetUri:t.uri,intent:_?"pause":"play",type:"click"});const e=y.playButtonFactory();let n;n=_?e.hitPause({itemToBePaused:t.uri}):v?e.hitResume({itemToBeResumed:t.uri}):e.hitPlay({itemToBePlayed:t.uri});const a=p.logInteraction(n);S({loggingParams:a})}}))),a.createElement("div",{onClick:T,className:x})))})),fe=a.memo((function(e){return d().isCollection(e.item.uri)?a.createElement(ue,(0,u.Z)({},e,{fallbackIcon:E.U})):a.createElement(_._,{menu:a.createElement(I.X,{uri:e.item.uri})},a.createElement(ue,(0,u.Z)({},e,{fallbackIcon:E.U})))})),de=a.memo((function(e){return a.createElement(_._,{menu:a.createElement(v.Y,{uri:e.item.uri})},a.createElement(ue,(0,u.Z)({},e,{fallbackIcon:g.c})))})),Ee=a.memo((function(e){return a.createElement(_._,{menu:a.createElement(S.m,{uri:e.item.uri})},a.createElement(ue,(0,u.Z)({},e,{fallbackIcon:h.a})))})),ge=a.memo((function(e){return a.createElement(_._,{menu:a.createElement(b.M,{uri:e.item.uri})},a.createElement(ue,(0,u.Z)({},e,{fallbackIcon:y.J,showPlayButton:!1})))})),he=a.memo((function(e){return a.createElement(_._,{menu:a.createElement(T.k,{uri:e.item.uri})},a.createElement(ue,(0,u.Z)({},e,{fallbackIcon:y.J,extraContent:a.createElement(K,e)})))}));var ye=n(11436),pe=n(49068);const _e="J6UEDIqMSJhYlwGoeUZB",ve="ZjFf4lVC48DSryAjP9qB",Se=a.memo((function(e){const t=(0,pe.x)(),n={...e.item,...t};return a.createElement(ue,(0,u.Z)({},e,{item:n,fallbackIcon:()=>a.createElement("div",{className:_e},a.createElement(ye.P,{iconSize:32,className:ve}))}))})),Te=270,Ie=a.memo((function({title:e,tagline:t,items:n}){const{fetchMultipleColors:r}=(0,m.WQ)(),[i,u]=(0,a.useState)({minWidth:Te,itemHeight:80,showPlayButton:!0}),f=!(0,c.k)(),E=(0,a.useRef)(null),g=e??(()=>{const e=(new Date).getHours();let t=p.ag.get("home.evening");return e>=5&&e<12?t=p.ag.get("home.morning"):e>=12&&e<18&&(t=p.ag.get("home.afternoon")),t})(),h=(0,a.useCallback)((()=>{if(!E.current)return;const e=E.current.offsetWidth,t=e<600?200:Te;const n=Math.min(Math.floor((e+24)/(t+24)),3);u({minWidth:t,showPlayButton:(e-24*(n-1))/n>=Te,itemHeight:e>=858?80:64})}),[]);if((0,o.a)((()=>{h()})),(0,a.useEffect)((()=>{h()}),[h]),(0,a.useEffect)((()=>{const e=n?.map(m.lh)||[];r(e)}),[n,r]),f||!n?.length)return null;const y=64===i.itemHeight?12:16;return a.createElement("section",{className:N,"aria-label":g,ref:E},a.createElement(s.r,{title:g,titleVariant:"alto",tagline:t}),a.createElement("div",{className:M,style:{"--min-column-width":`${i.minWidth}px`,"--column-gap":"24px","--row-gap":`${y}px`,"--item-height":`${i.itemHeight}px`}},n.filter(((e,t)=>t<6)).map(((e,t)=>{if((e=>{if(null!==e&&"object"==typeof e){const{type:t,name:n}=e;return t===l.p.YOUR_EPISODES&&"string"==typeof n}return!1})(e))return a.createElement(Se,{index:t,key:`${t}-${e.uri}`,item:e,showPlayButton:i.showPlayButton,shouldSetBackgroundColor:0===t});const n=function(e){const t=(d().from(e)||{}).type;switch(t){case d().Type.ARTIST:return Ee;case d().Type.ALBUM:case d().Type.COLLECTION_ALBUM:return de;case d().Type.PLAYLIST:case d().Type.PLAYLIST_V2:return fe;case d().Type.SHOW:return ge;case d().Type.EPISODE:return he;case d().Type.COLLECTION:return fe;default:return console.warn(`Unable to resolve entity shortcut from ${e} of type "${t||"unknown"}"`),ge}}(e.uri);return a.createElement(n,{index:t,key:`${t}-${e.uri}`,item:e,showPlayButton:i.showPlayButton,shouldSetBackgroundColor:0===t})}))))})),be=(0,r.P)(Ie,(()=>null),(e=>(0,i.vK)(e,"HomeShortcutsGrid")))},96421:(e,t,n)=>{n.r(t),n.d(t,{HOME_REFRESH_TIMEOUT:()=>N,default:()=>M});var a=n(67294),r=n(94184),o=n.n(r),i=n(86706),l=n(73526),c=n(96206),s=n(70369),m=n(70105),u=n(6158),f=n(41737),d=n(29608),E=n(87577),g=n(87961),h=n(99195),y=n(23716),p=n(74845),_=n(8247),v=n(8271);const S="PLAY_AT_FIRST_TAP_HAD_DEFERRED_ACTIONS";function T(e){const t=(0,E.W6)(_.Qs),[n,r]=(0,a.useState)(void 0),[o,l]=(0,a.useState)(void 0),[c,s]=(0,a.useState)(!1),m=(0,y.g)(),u=(0,i.v9)((({session:e})=>e.user&&e.user.id)),f=(0,v.s4)(),T=(0,a.useCallback)((function(e){const t=(0,d.x)(e);f.send(t)}),[f]);(0,a.useEffect)((()=>{l(!!window.sessionStorage.getItem(S)&&(window.sessionStorage.removeItem(S),!0))}),[]),(0,a.useEffect)((()=>{u&&(T({category:"play-at-first-tap",label:"log_attempt",os:(0,h.y)(),context:"ab_v3"}),s((e=>!!window.sessionStorage.getItem(`PLAY_AT_FIRST_TAP_APPLIED_${e}`))(u)),(0,p.M)(g.b.getInstance()).then((e=>{r(e.content.items.length>0)})).catch((()=>{T({category:"play-at-first-tap",label:"recently-played-failed",os:(0,h.y)(),context:"ab_v3"}),r(!0)})))}),[u,T]),(0,a.useEffect)((()=>{if(void 0===n||void 0===o||!e||!u||c)return;const a=!n&&!o;if(a){(e=>{window.sessionStorage.setItem(`PLAY_AT_FIRST_TAP_APPLIED_${e}`,JSON.stringify(!0))})(u);const n=(e=>{const t=e.content.items.find((e=>{const t="CAROUSEL"===e.rendering,n="LIST"===e.rendering&&"shortcuts"!==e.id;return t||n}));if(!t)return;const n=t.content.items.find((e=>!e.publisher||!e.publisher.startsWith("Spotify")));return n&&n.uri})(e);n&&t&&m.play({uri:n},{featureIdentifier:"home",referrerIdentifier:"home"},{paused:!0}),T({category:"play-at-first-tap",label:"play_content",os:(0,h.y)(),context:n||"no_valid_uri_retrieved"})}T({category:"play-state",label:a?"has_valid_state_yes":"has_valid_state_no",os:(0,h.y)(),context:"ab_v3"})}),[c,n,e,o,m,u,t,T])}var I=n(13983),b=n(49552),P=n(29255),w=n(42922),k=n(54444),A=n(23060),C=n(29393),B=n(33528);const N=18e5,M=a.memo((function(){const{isAnonymous:e}=(0,i.v9)(P.Gg),t=(0,C.v8)(e),{view:n}=(0,b.P)(t,{cacheTime:N}),{spec:r,UBIFragment:d}=(0,k.fU)(l.createDesktopHomeEventFactory,{data:{identifier:t,uri:"spotify:home"}});(0,I.z)("home"),T(n);const E=n?.content.items,[g,h]=(0,a.useMemo)((()=>{const e=[];let t=null;if(Array.isArray(E))for(let n=0;n<E.length;n++){const a=E[n];"shortcuts"===a.id?t=a:e.push(a)}return[t,e]}),[E]);return a.createElement(d,{spec:r},a.createElement(s.$,null,c.ag.get("page.generic-title")),a.createElement(a.Suspense,{fallback:null},a.createElement(A.S,null)),n?a.createElement("section",{"data-testid":"home-page"},a.createElement("div",{className:B.Z.home},a.createElement("div",{className:o()(B.Z.content,"contentSpacing")},g?a.createElement(d,{spec:r.shortcutsFactory()},a.createElement(w.JL,{value:"headered-grid",key:g.id},a.createElement(m.n,{items:g.content.items,title:g.name,tagline:g.tag_line}))):null,a.createElement(d,{spec:r.shelvesFactory()},a.createElement(f.c,{spaces:h,viewName:n.name,viewId:t,isAnonymous:e}))))):a.createElement(u.h,{hasError:!1,errorMessage:c.ag.get("error.not_found.title.page")}))}))},23060:(e,t,n)=>{n.d(t,{S:()=>c});var a=n(67294),r=n(87577),o=n(49207),i=n(28638),l=n(62572);const c=()=>(0,r.W6)(o.Jw)===o.pF.ONHOME?a.createElement(i.w,null,a.createElement(l.M,{onSearch:!1})):null}}]);
//# sourceMappingURL=home-v1.js.map